{"version":3,"sources":["pages/ContractDetection/component/ErrModel.tsx","pages/ContractDetection/component/StyleCode.jsx","pages/ContractDetection/index.tsx"],"names":["ErrModel","isOpen","onDismiss","errorMsg","minWidth","maxWidth","minHeight","className","onClick","myCodeMirror","StyleCode","value","useEffect","textArea","document","getElementById","CodeMirror","fromTextArea","theme","lineNumbers","firstLineNumber","lineWrapping","scrollbarStyle","tabSize","smartIndent","indentUnit","indentWithTabs","autofocus","gutters","foldGutter","mode","styleActiveLine","matchBrackets","autoCloseBrackets","hintOptions","completeSingle","readOnly","setOption","on","showHint","id","name","Option","Select","inputRegex","RegExp","contrastRegex","Input","onUserInput","placeholder","ShowRed","setcontrastErrText","rest","onChange","event","nextUserInput","target","test","autoComplete","autoCorrect","type","onBlur","e","baseURL","getEnv","ContractDetection","account","useActiveWeb3React","toggleWalletModal","useWalletModalToggle","history","useHistory","useState","currIndex","setcurrIndex","AddressContract","setAddressContract","FileValue","setFileValue","FileShow","setFileShow","selectChain","setselectChain","contrastErrText","ErrOpen","setErrOpen","seterrorMsg","detectIng","setdetectIng","CurrentTestId","setCurrentTestId","TotalTest","setTotalTest","Testing","setTesting","TakeResultAllTime","setTakeResultAllTime","showUploadFileButton","setshowUploadFileButton","overTimer","setoverTimer","detectContrast","useCallback","GetTestStatusStart","styleButton","useMemo","rst","text","disabled","Id","localStorage","getItem","console","log","ViewTestResult","detectFile","handelFiret","getUserNonce","address","then","res","code","Params","nonce","data","getUserToCore","re","token","window","sessionStorage","setItem","msg","testid","getTestResult","JSON","stringify","Number","setTimeout","push","getTestStatus","addr","status","params","network","getDetectAddressSubmit","testAddress","PageStart","getListsTotal","timer1","defaultValue","dropdownClassName","showArrow","src","bscPic","alt","ethPic","val","accept","file","files","formdata","FormData","set","xml","XMLHttpRequest","open","setRequestHeader","send","onload","parse","responseText","reader","FileReader","contents","result","readAsText"],"mappings":"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","file":"static/js/13.17fe1a9b.chunk.js","sourcesContent":["import React from 'react'\nimport PcModal from \"../../../components/Modal/PcModal\"\nimport { ErrWraper } from '../styled'\n\n\n\nexport default function ErrModel({\n    isOpen,\n    onDismiss,\n    errorMsg,\n  }:  {\n    isOpen:boolean,\n    onDismiss:()=>void,\n    errorMsg:string\n  }) {\n    return (\n        <PcModal isOpen={isOpen} minWidth={384} maxWidth={384} onDismiss={onDismiss} minHeight={214}>\n            <ErrWraper>\n                <div className='notice'>Notice</div>\n                <div className=\"info\">{errorMsg}</div>\n                <div className=\"button\" onClick={()=>{\n                  onDismiss()\n                }}>OK</div>\n            </ErrWraper>\n        </PcModal>\n    )\n  }","import React, { useEffect } from 'react'\n\nimport { StyleCodeDom } from '../styled'\nimport CodeMirror from 'codemirror';\nimport 'codemirror/lib/codemirror.css'\n//主题\nimport 'codemirror/theme/material.css';\nimport 'codemirror/theme/solarized.css'\nimport 'codemirror/theme/panda-syntax.css'\n// 折叠代码\nimport 'codemirror/addon/fold/foldgutter.css';\nimport 'codemirror/addon/fold/foldcode.js';\nimport 'codemirror/addon/fold/foldgutter.js';\nimport 'codemirror/addon/fold/brace-fold.js';\nimport 'codemirror/addon/fold/comment-fold.js';\nimport 'codemirror/addon/fold/indent-fold.js';\n\n// 代码提示\nimport 'codemirror/addon/hint/show-hint.css'; //\nimport 'codemirror/addon/hint/show-hint.js';\nimport 'codemirror/addon/hint/anyword-hint.js'; // 简单提示，按需引入，spl可引入sql-hint.js\n\nimport \"codemirror/addon/comment/comment.js\";\n// 高亮\nimport \"codemirror/addon/selection/active-line.js\";\n\n// python语言\nimport \"codemirror/mode/python/python.js\";\n\n// 括号匹配\nimport \"codemirror/addon/edit/closebrackets.js\";\nimport \"codemirror/addon/edit/matchbrackets.js\";\n\nimport 'codemirror/addon/lint/lint.js'\nimport 'codemirror/addon/lint/javascript-lint.js'\n\n\n\nlet myCodeMirror;\n\n\n\nexport function StyleCode({ value }) {\n    useEffect(() => {\n        const textArea = document.getElementById(\"code\");\n        myCodeMirror = CodeMirror.fromTextArea(textArea, {\n            theme: 'panda-syntax',//主题\n            lineNumbers: true,//显示行号\n            firstLineNumber: 1,//行号从几开始，默认1\n            lineWrapping: true,//滚动或换行\n            scrollbarStyle: null,//隐藏滚动条样式\n            tabSize: 2, //tab键缩进,默认4\n            smartIndent: true, // 智能缩进\n            indentUnit: 2, // 智能缩进单位为2个空格长度\n            indentWithTabs: true, // 使用制表符进行智能缩进\n            autofocus: true,//自动获取焦点\n            // 在行槽中添加行号显示器、折叠器、语法检测器\n            gutters: [\"CodeMirror-linenumbers\", \"CodeMirror-foldgutter\", \"CodeMirror-lint-markers\"],\n            foldGutter: true, // 启用行槽中的代码折叠\n            mode: \"python\", // 要使用的模式//https://codemirror.net/mode/\n            styleActiveLine: true, // 显示选中行的样式\n            matchBrackets: true,\t//括号匹配\n            autoCloseBrackets: true,//括号自动补全，()[]{}''\"\"\n            hintOptions: {\n                completeSingle: false//代码自动补全功能不默认补充\n            },\n            readOnly: true,\n        });\n        myCodeMirror.setOption(\"value\", 'print(\"hello word\")');//初始值\n        myCodeMirror.on(\"keypress\", function () {//代码补全功能\n            myCodeMirror.showHint();\n        });\n        if(value !==''){\n            myCodeMirror.setOption(\"value\",value);//初始值\n        }\n        \n        // myCodeMirror.setSize('40vw', '50vh');//编辑框大小(宽，高)\n    }, [value])\n\n\n    return <StyleCodeDom >\n\n        <textarea id=\"code\" name=\"code\"> </textarea>\n\n    </StyleCodeDom>\n}\n\n\n\n","import React, { useCallback, useEffect, useMemo, useState } from 'react'\nimport ethPic from '../../assets/images/contrastDetec/ethPic.png'\nimport bscPic from '../../assets/images/contrastDetec/bscPic.png'\nimport ErrModel from './component/ErrModel'\n\nimport './antd.scss'\nimport { useActiveWeb3React } from '../../hooks'\nimport { useWalletModalToggle } from '../../state/application/hooks'\nimport { StyleCode } from './component/StyleCode'\nimport { ContainerCon, FileContent, ShowDecting, StyleButton, StyledInput, StyleSolInputUp, WidthDiv } from './styled'\nimport { Select } from 'antd';\nimport { useHistory } from 'react-router-dom'\nimport { getDetectAddressSubmit, getListsTotal, getTestResult, getTestStatus, getUserNonce, getUserToCore } from '../../utils/fetch/detect'\nimport { Dots, SmallLoading } from '../../components/styleds'\nimport { getEnv } from '../../utils/base/string'\nimport { clearTimeout } from 'timers'\nconst { Option } = Select;\n\n// const inputRegex = RegExp(/^\\d+\\.?(\\d{1})?$/)\nconst inputRegex = RegExp(/^[a-zA-Z\\d]+$/)\nconst contrastRegex = RegExp(/^0x[a-fA-F0-9]{40}$/)\nfunction Input({\n    value,\n    onUserInput,\n    placeholder,\n    ShowRed,\n    setcontrastErrText,\n    ...rest\n}: {\n    value: string | number\n    onUserInput: (input: string) => void\n    setcontrastErrText: (e: any) => void\n    error?: boolean\n    ShowRed?: boolean\n    placeholder?: string\n} & Omit<React.HTMLProps<HTMLInputElement>, 'ref' | 'onChange' | 'as'>) {\n\n    const enforcer = (nextUserInput: string) => {\n        if (inputRegex.test(nextUserInput) || !nextUserInput) {\n            onUserInput(nextUserInput)\n        }\n    }\n    const testInput = (e: any) => {\n        if (contrastRegex.test(e.target.value)) {\n            setcontrastErrText('')\n        } else {\n            setcontrastErrText('Notice：Address is validated incorrectly')\n        }\n    }\n\n\n    return (\n        <StyledInput\n            {...rest}\n            value={value}\n            onChange={event => enforcer(event.target.value)}\n            autoComplete=\"off\"\n            autoCorrect=\"off\"\n            type=\"text\"\n            ShowRed={ShowRed}\n            placeholder={placeholder || ''}\n            onBlur={event => testInput(event)}\n        />\n\n    )\n}\n\n\ninterface BtnProp {\n    disabled: boolean\n    text: JSX.Element | string\n    event?: () => void\n}\nconst baseURL = getEnv('REACT_APP_DEV_REQUEST_URL')\nexport default function ContractDetection(): JSX.Element {\n\n    const { account } = useActiveWeb3React()\n    const toggleWalletModal = useWalletModalToggle()\n    const history = useHistory()\n\n    const [currIndex, setcurrIndex] = useState(0)\n    const [AddressContract, setAddressContract] = useState('')\n\n    const [FileValue, setFileValue] = useState('')\n    const [FileShow, setFileShow] = useState(false)\n    const [selectChain, setselectChain] = useState('bsc')\n\n\n    const [contrastErrText, setcontrastErrText] = useState('')\n    const [ErrOpen, setErrOpen] = useState(false)\n    const [errorMsg, seterrorMsg] = useState('')\n\n    const [detectIng, setdetectIng] = useState(false)\n\n    const [CurrentTestId, setCurrentTestId] = useState('' as unknown as number)\n    const [TotalTest, setTotalTest] = useState(0)\n\n    const [Testing, setTesting] = useState(false)\n    const [TakeResultAllTime, setTakeResultAllTime] = useState(false)\n    const [showUploadFileButton, setshowUploadFileButton] = useState(false)\n    const [overTimer, setoverTimer] = useState(false)\n    let timer1: any;\n    //上传文件\n    function readSingleFile(e: any) {\n        var file = e.target.files[0];\n        if (!file) { return; }\n\n        const formdata = new FormData();\n        // 这里只是基本设置，对应接口需求设置响应的类型属性值\n        formdata.set('file', file);\n        formdata.set('main_file', file.name);\n\n        // 接口调用\n        let xml = new XMLHttpRequest();\n        xml.open('POST', baseURL + '/upload/', true)\n        xml.setRequestHeader('Authorization', window.sessionStorage.getItem('token') || '');\n\n        xml.send(formdata)\n\n        xml.onload = (res) => {\n            const { code, data, msg } = JSON.parse(xml.responseText)\n\n            if (code === 30001) {\n                setErrOpen(true)\n                seterrorMsg(msg)\n            }\n            if (code === 500) {\n                setErrOpen(true)\n                seterrorMsg('The service is busy, please try again')\n            }\n            if (code === 200) {\n                if (data.status === 2) {\n                    setErrOpen(true)\n                    seterrorMsg(msg)\n                }\n                if (data.status === 1) {\n                    setErrOpen(true)\n                    seterrorMsg(msg)\n                }\n                \n\n                if (data.id) {\n                    setCurrentTestId(data.id)\n                    localStorage.setItem('CurrentTestId', data.id)\n                    localStorage.setItem('TakeResultAllTime', 'true')\n                    setshowUploadFileButton(true)\n                }\n            }\n        }\n\n        var reader = new FileReader();\n        reader.onload = function (e: any) {\n            var contents = e.target.result;\n            setFileValue(contents)\n            setFileShow(true)\n\n        };\n        reader.readAsText(file, \"utf-8\");\n    }\n    //合约地址检测\n    const detectContrast = useCallback(\n        () => {\n\n            if (!contrastRegex.test(AddressContract)) {\n                setcontrastErrText('Notice：Address is validated incorrectly')\n            } else {\n                setcontrastErrText('')\n                GetTestStatusStart()\n            }\n        },\n        // eslint-disable-next-line\n        [AddressContract, history, account],\n    )\n    const testAddress = () => {\n        console.log(selectChain, 'selectChain');\n\n        const params = {\n            address: AddressContract,\n            network: localStorage.getItem('chain')\n        }\n\n        getDetectAddressSubmit(params).then((res: any) => {\n            const { code, data, msg } = res\n            if (code === 30001) {\n                setErrOpen(true)\n                seterrorMsg(msg)\n            }\n            if (code === 500) {\n                setErrOpen(true)\n                seterrorMsg('The service is busy, please try again')\n            }\n            if (code === 200) {\n                const { id } = data\n                setCurrentTestId(id)\n                localStorage.setItem('CurrentTestId', id)\n                localStorage.setItem('TakeResultAllTime', 'true')\n                setdetectIng(true)\n                ViewTestResult(id)\n            }\n        })\n\n\n\n\n    }\n\n\n    const detectFile = () => {\n        const Id = CurrentTestId || localStorage.getItem('CurrentTestId')\n        console.log(Id, 'Id');\n        if (Id) {\n            ViewTestResult(Id)\n\n        }\n\n    }\n\n\n    //关闭错误弹框\n    const closeErrTip = () => {\n        setErrOpen(false)\n        seterrorMsg('')\n        setcontrastErrText('')\n        setFileValue('')\n        setFileShow(false)\n        setAddressContract('')\n        setdetectIng(false)\n    }\n\n    const styleButton: BtnProp = useMemo(() => {\n        const rst: BtnProp = {\n            text: 'Start detection',\n            event: () => ({}),\n            disabled: true\n        }\n        if (!account) {\n            rst.text = 'Connect Wallet'\n            rst.disabled = false\n            rst.event = () => {\n                toggleWalletModal()\n            }\n            return rst\n        }\n\n        if (detectIng) {\n            rst.text = (\n                <>\n                    <SmallLoading />\n                    Detecting\n                    <Dots />\n                </>\n            )\n            return rst\n        }\n        if(overTimer){\n            rst.text = 'Too many requests, please wait'\n            return rst\n        }\n        return {\n            text: 'Start detection',\n            event: () => { currIndex === 0 ? detectContrast() : detectFile() },\n            disabled: false\n        }\n        // eslint-disable-next-line\n    }, [\n        account,\n        toggleWalletModal,\n        detectContrast,\n        currIndex,\n        detectIng,\n        useActiveWeb3React,\n        overTimer\n    ])\n    const handleChange = (value: any) => {\n        setselectChain(value)\n        localStorage.setItem('chain', value)\n    }\n    //获取nonce\n    const handelFiret = useCallback(\n        () => {\n            if (!account) return\n\n            getUserNonce({ address: account }).then((res: any) => {\n                if (res.code === 200) {\n                    const { nonce } = res.data\n                    const Params = { nonce: nonce, address: account }\n                    getUserToCore(Params).then((re: any) => {\n                        if (re.code === 200) {\n                            const { token } = re.data\n                            window.sessionStorage.setItem('token', 'Bearer ' + token)\n                            GetTestStatusStart()\n                        } else {\n                            setErrOpen(true)\n                            seterrorMsg(re.msg)\n                        }\n\n\n                    })\n                } else {\n                    setErrOpen(true)\n                    seterrorMsg(res.msg)\n                }\n\n            })\n        },\n        // eslint-disable-next-line\n        [account],\n    )\n\n\n\n    //检测总数\n    const handleListTotal = () => {\n        getListsTotal().then(res => {\n            if (res.data) {\n                setTotalTest(res.data)\n            }\n        })\n    }\n    //查看检测结果\n    const ViewTestResult = useCallback(\n        (testid: any) => {\n\n            getTestResult({ id: testid }).then((res: any) => {\n                const { code, data, msg } = res\n                if (code === 200) {\n                    if (JSON.stringify(data) === '{}') {\n                        console.log(TakeResultAllTime, 'TakeResultAllTime==>', localStorage.getItem('TakeResultAllTime'), testid, localStorage.getItem('CurrentTestId'), localStorage.getItem('TakeResultAllTime') === 'true' && Number(testid) === Number(localStorage.getItem('CurrentTestId')));\n\n                        if (localStorage.getItem('TakeResultAllTime') === 'true' && Number(testid) === Number(localStorage.getItem('CurrentTestId'))) {\n                            setdetectIng(true)\n                            setTimeout(() => {\n                                ViewTestResult(testid)\n                            }, 3000);\n                        }\n\n                    } else {\n                        setTesting(false)\n                        setdetectIng(false)\n\n                        const Id = CurrentTestId || localStorage.getItem('CurrentTestId')\n                        history.push(`/contract_detection/${Id}`)\n                    }\n                } else if(code === 201){\n                    if (localStorage.getItem('TakeResultAllTime') === 'true' && Number(testid) === Number(localStorage.getItem('CurrentTestId'))) {\n                        setoverTimer(true)\n                        setdetectIng(false)\n                        setTimeout(() => {\n                            ViewTestResult(testid)\n                        }, 3000);\n                    }\n                    \n                }   \n                \n                \n                else {\n                    setErrOpen(true)\n                    seterrorMsg(msg)\n                    localStorage.setItem('TakeResultAllTime', 'false')\n                    \n                }\n\n            })\n        },\n        [TakeResultAllTime, CurrentTestId, history],\n    )\n\n\n    //查询检测状态 0 （可以继续检测）1（当前正在检测）2（检测上限）\n    const GetTestStatusStart = useCallback(\n        () => {\n\n            if (!account) return\n\n            getTestStatus({ addr: account }).then((res: any) => {\n\n                if (res.code === 200) {\n                    const { data, msg } = res\n                    if (data.status === 2) {\n                        setErrOpen(true)\n                        seterrorMsg(msg)\n                    }\n                    if (data.status === 1) {\n\n                        localStorage.setItem('CurrentTestId', data.id)\n                        localStorage.setItem('TakeResultAllTime', 'true')\n                        setTakeResultAllTime(true)\n                        setTimeout(() => {\n                            setTesting(true)\n                            ViewTestResult(data.id)\n                        }, 0);\n\n                    }\n                    if (data.status === 0) {\n                        setTesting(false)\n                        setdetectIng(false)\n\n                        if (contrastRegex.test(AddressContract)) {\n                            testAddress()\n                        }\n\n                    }\n                }\n\n                else {\n\n                    setErrOpen(true)\n                    seterrorMsg(res.msg)\n                }\n\n\n            })\n        },\n        // eslint-disable-next-line\n        [AddressContract, ViewTestResult, account, selectChain],\n    )\n\n\n    //初始化\n    const PageStart = useCallback(\n        () => {\n            setErrOpen(false)\n            seterrorMsg('')\n            setcontrastErrText('')\n            setFileValue('')\n            setFileShow(false)\n            setcurrIndex(0)\n            setAddressContract('')\n            setTakeResultAllTime(false)\n            setoverTimer(false)\n            localStorage.setItem('TakeResultAllTime', 'false')\n            \n        },\n        // eslint-disable-next-line\n        [account],\n    )\n\n\n    useEffect(() => {\n        localStorage.setItem('chain', 'bsc')\n        handelFiret()\n        handleListTotal()\n        PageStart()\n        // eslint-disable-next-line\n        return () => {\n\n            if (timer1) {\n                clearTimeout(timer1)\n            }\n        }\n        // eslint-disable-next-line\n    }, [account])\n\n\n\n\n    return <ContainerCon className=\"ContractDetection\">\n        <div className=\"homeContainer\">\n            <div className=\"container\">\n                <WidthDiv className='ContracDec'>\n                    <div className=\"title\">Triathon Contract Detection</div>\n                    <div className=\"tabs\">\n                        <span className={currIndex === 0 ? 'active tab1' : 'tab1'} onClick={() => setcurrIndex(0)}>Detect with address</span>\n                        <span className={currIndex === 1 ? 'active tab2' : 'tab2'} onClick={() => setcurrIndex(1)}>Detect with file</span>\n                    </div>\n                    {\n                        Testing ? <ShowDecting>\n                            {\n                                overTimer?\n                                <>\n                                 <div className=\"loading\"></div>\n                                <div className='text'>Too many requests, please wait</div>\n                                </>:<>\n                                 <div className=\"loading\"></div>\n                            <div className=\"text\">Detecting…</div>\n                                </>\n                            }\n                           \n                        </ShowDecting> : (\n                            currIndex === 0 ? <div className=\"addreccCon\">\n                                <div className=\"select\">\n                                    <Select defaultValue=\"bsc\" onChange={handleChange} dropdownClassName='dropCon' showArrow >\n                                        <Option value=\"bsc\">  <img src={bscPic} alt=\"\" /> BSC</Option>\n                                        <Option value=\"eth\">  <img src={ethPic} alt=\"\" /> ETH</Option>\n                                    </Select>\n                                </div>\n                                <div className=\"inputCon\">\n                                    <Input value={AddressContract} onUserInput={val => setAddressContract(val)} placeholder='Please enter the contact address' ShowRed={contrastErrText === '' || AddressContract === ''} setcontrastErrText={setcontrastErrText} ></Input>\n                                </div>\n                                <div className=\"err\">{contrastErrText}</div>\n                            </div> : <div className=\"fileCon\">\n                                {\n                                    !FileShow ? <div className=\"uploadBefore\"><StyleSolInputUp >\n                                        <span></span>\n                                        Upload file (.sol)\n                                        <input type=\"file\" id='file-input' accept=\".sol\" onChange={readSingleFile} />\n                                    </StyleSolInputUp></div> : <FileContent>\n                                        {\n                                            FileValue !== '' && <StyleCode value={FileValue}></StyleCode>\n                                        }\n                                    </FileContent>\n                                }\n\n                            </div>\n                        )\n                    }\n\n                    {\n                        (currIndex === 0 && !Testing) ? <StyleButton onClick={styleButton.event}>{styleButton.text}</StyleButton> : (\n                            !account ? <StyleButton onClick={() => {\n                                toggleWalletModal()\n                            }} > Connect Wallet </StyleButton> : (FileValue !== '' && !Testing && showUploadFileButton) && <StyleButton onClick={styleButton.event}>{styleButton.text}</StyleButton>\n                        )\n                    }\n\n\n                    <div className=\"notice\">Notice : This detection is the basic item scan, please do not treat it as the final audit report.For the final report, please contract customer service for manual audit ( email : triathonspace@gmail.com )</div>\n                    <div className=\"detect\" >\n                        <span onClick={() => {\n                            history.push('/contract_detection/history')\n                        }} >\n                            {TotalTest}+ Detected <span className='pointRight'></span>\n                        </span>\n                    </div>\n                </WidthDiv>\n            </div>\n            <div className=\"playContainer\">\n\n           \n            <div className=\"play1\"></div>\n            <div className=\"play2\"></div>\n            <div className=\"play3\"></div>\n            <div className=\"play4\"></div>\n            <div className=\"play5\"></div>\n            <div className=\"play6\"></div>\n            </div>\n        </div>\n\n        <ErrModel\n            isOpen={ErrOpen}\n            onDismiss={closeErrTip}\n            errorMsg={errorMsg}\n        ></ErrModel>\n    </ContainerCon>\n}"],"sourceRoot":""}