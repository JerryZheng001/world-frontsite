{"version":3,"sources":["pages/ContractDetection/component/ErrModel.tsx","pages/ContractDetection/index.tsx"],"names":["ErrModel","isOpen","onDismiss","errorMsg","minWidth","maxWidth","minHeight","className","onClick","contrastRegex","RegExp","ContractDetection","timer1","account","useActiveWeb3React","toggleWalletModal","useWalletModalToggle","history","useHistory","useState","currIndex","setcurrIndex","AddressContract","setAddressContract","selectChain","setselectChain","contrastErrText","setcontrastErrText","ErrOpen","setErrOpen","seterrorMsg","detectIng","setdetectIng","TotalTest","setTotalTest","Testing","setTesting","overTimer","setoverTimer","detectContrast","push","testAddress","type","newParams","params","token_address","chain","localStorage","getItem","user_address","getDetectAddressSubmit","then","res","code","data","msg","JSON","stringify","setTimeout","id","clearTimeout","styleButton","useMemo","rst","text","event","disabled","GetTestStatusStart","useCallback","timer2","getTestStatus","status","address","setItem","reParams","test","PageStart","useEffect","getListsTotal","total","catch","e","console","log","src","AddressIcon","alt","window","open","leftShowPic","rightShowPic"],"mappings":"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","file":"static/js/11.b49f5f84.chunk.js","sourcesContent":["import React from 'react'\nimport PcModal from \"../../../components/Modal/PcModal\"\nimport { ErrWraper } from '../styled'\n\n\n\nexport default function ErrModel({\n    isOpen,\n    onDismiss,\n    errorMsg,\n  }:  {\n    isOpen:boolean,\n    onDismiss:()=>void,\n    errorMsg:string\n  }) {\n    return (\n        <PcModal isOpen={isOpen} minWidth={384} maxWidth={384} onDismiss={onDismiss} minHeight={214}>\n            <ErrWraper>\n                <div className='notice'>Notice</div>\n                <div className=\"info\">{errorMsg}</div>\n                <div className=\"button\" onClick={()=>{\n                  onDismiss()\n                }}>OK</div>\n            </ErrWraper>\n        </PcModal>\n    )\n  }","import React, { useCallback, useEffect, useMemo, useState } from 'react'\n// import ethPic from '../../assets/images/tokenDetec/ethPic@2x.png'\n// import bscPic from '../../assets/images/tokenDetec/bscPic@2x.png'\n// // import tronPic from '../../assets/images/tokenDetec/avaPic@2x.png'\n// import polyPic from '../../assets/images/tokenDetec/polyPic@2x.png'\n// import avaPic from '../../assets/images/tokenDetec/tronPic@2x.png'\n// import optimismPic from '../../assets/images/tokenDetec/optimismPic.png'\n\n\nimport ErrModel from './component/ErrModel'\nimport leftShowPic from '../../assets/images/tokenDetec/leftShowPic.png'\nimport rightShowPic from '../../assets/images/tokenDetec/rightShowPic.png'\nimport AddressIcon from '../../assets/images/address_icon.png'\nimport './antd.scss'\nimport { useActiveWeb3React } from '../../hooks'\nimport { useWalletModalToggle } from '../../state/application/hooks'\nimport { BottomDiv, ComingDiv, ContainerCon, IntroDiv, ShowDecting, StyleButton, WidthDiv } from './styled'\n// import { Select } from 'antd';\nimport { useHistory } from 'react-router-dom'\nimport { getDetectAddressSubmit, getListsTotal, getTestStatus } from '../../utils/fetch/detect'\nimport { Dots, SmallLoading } from '../../components/styleds'\nimport { clearTimeout } from 'timers'\n// const { Option } = Select;\n\n// const inputRegex = RegExp(/^\\d+\\.?(\\d{1})?$/)\n// const inputRegex = RegExp(/^[a-zA-Z\\d]+$/)\nconst contrastRegex = RegExp(/^0x[a-fA-F0-9]{40}$/)\n// function Input({\n//     value,\n//     onUserInput,\n//     placeholder,\n//     ShowRed,\n//     setcontrastErrText,\n//     ...rest\n// }: {\n//     value: string | number\n//     onUserInput: (input: string) => void\n//     setcontrastErrText: (e: any) => void\n//     error?: boolean\n//     ShowRed?: boolean\n//     placeholder?: string\n// } & Omit<React.HTMLProps<HTMLInputElement>, 'ref' | 'onChange' | 'as'>) {\n\n//     const enforcer = (nextUserInput: string) => {\n//         if (inputRegex.test(nextUserInput) || !nextUserInput) {\n//             onUserInput(nextUserInput)\n//         }\n//     }\n//     const testInput = (e: any) => {\n//         if (contrastRegex.test(e.target.value)) {\n//             setcontrastErrText('')\n//         } else {\n//             setcontrastErrText('Notice：Address is validated incorrectly')\n//         }\n//     }\n\n\n//     return (\n//         <StyledInput\n//             {...rest}\n//             value={value}\n//             onChange={event => enforcer(event.target.value)}\n//             autoComplete=\"off\"\n//             autoCorrect=\"off\"\n//             type=\"text\"\n//             ShowRed={ShowRed}\n//             placeholder={placeholder || ''}\n//             onBlur={event => testInput(event)}\n//         />\n\n//     )\n// }\n\n\ninterface BtnProp {\n    disabled: boolean\n    text: JSX.Element | string\n    event?: () => void\n}\nexport default function ContractDetection(): JSX.Element {\n\n    const { account } = useActiveWeb3React()\n    const toggleWalletModal = useWalletModalToggle()\n    const history = useHistory()\n\n    const [currIndex, setcurrIndex] = useState(0)\n    const [AddressContract, setAddressContract] = useState('')\n\n    const [selectChain, setselectChain] = useState('BSC')\n\n\n    const [contrastErrText, setcontrastErrText] = useState('')\n    const [ErrOpen, setErrOpen] = useState(false)\n    const [errorMsg, seterrorMsg] = useState('')\n\n    const [detectIng, setdetectIng] = useState(false)\n\n    const [TotalTest, setTotalTest] = useState(0)\n\n    const [Testing, setTesting] = useState(false)\n    // const [TakeResultAllTime, setTakeResultAllTime] = useState(false)\n    const [overTimer, setoverTimer] = useState(false)\n    let timer1: any;\n\n    //合约地址检测\n    // const detectContrast = useCallback(\n    //     () => {\n\n    //         if (!contrastRegex.test(AddressContract)) {\n    //             setcontrastErrText('Notice：Address is validated incorrectly')\n    //         } else {\n    //             setcontrastErrText('')\n    //             setdetectIng(true)\n    //             GetTestStatusStart()\n    //         }\n    //     },\n    //     // eslint-disable-next-line\n    //     [AddressContract, history, account, selectChain, localStorage.getItem('chain')],\n    // )\n    const detectContrast =(()=>{\n        history.push('/contract_detection/history')\n    })\n    //token检测\n    const testAddress = (type?:number,newParams?:any) => {\n        const params = {\n            token_address: AddressContract,\n            chain: localStorage.getItem('chain'),\n            user_address: account\n        }\n        getDetectAddressSubmit(type===1?newParams:params).then((res: any) => {\n            const { code, data, msg } = res\n            if (code === 200) {\n                if (JSON.stringify(data) === '{}') {\n                    timer1 = setTimeout(() => {\n                        testAddress()\n                    }, 3000);\n                } else {\n                    const { id } = data\n\n                    clearTimeout(timer1)\n                    setTimeout(() => {\n                        setTesting(false)\n                        setdetectIng(false)\n                        history.push(`/contract_detection/${id}`)\n                    }, 1000);\n                }\n            } else {\n                setErrOpen(true)\n                seterrorMsg(msg)\n            }\n        })\n    }\n\n\n\n\n\n    //关闭错误弹框\n    const closeErrTip = () => {\n        setErrOpen(false)\n        seterrorMsg('')\n        setcontrastErrText('')\n        setAddressContract('')\n        setdetectIng(false)\n        setTesting(false)\n    }\n\n    const styleButton: BtnProp = useMemo(() => {\n        const rst: BtnProp = {\n            text: 'Start detection',\n            event: () => ({}),\n            disabled: true\n        }\n        if (!account) {\n            rst.text = 'Connect Wallet'\n            rst.disabled = false\n            rst.event = () => {\n                toggleWalletModal()\n            }\n            return rst\n        }\n\n        if (detectIng) {\n            rst.text = (\n                <>\n                    <SmallLoading />\n                    Detecting\n                    <Dots />\n                </>\n            )\n            return rst\n        }\n        if (overTimer) {\n            rst.text = 'Too many requests, please wait'\n            return rst\n        }\n        return {\n            text: 'Start detection',\n            event: () => { detectContrast() },\n            disabled: false\n        }\n        // eslint-disable-next-line\n    }, [\n        account,\n        toggleWalletModal,\n        detectContrast,\n        currIndex,\n        detectIng,\n        useActiveWeb3React,\n        overTimer,\n        selectChain,\n        // eslint-disable-next-line\n        localStorage.getItem('chain'),\n        AddressContract\n    ])\n    // const handleChange = (value: any) => {\n    //     setselectChain(value)\n    //     localStorage.setItem('chain', value)\n    // }\n\n    //检测总数\n    const handleListTotal = () => {\n        getListsTotal().then(res => {\n            if (res.data) {\n                const { total } = res.data\n                setTotalTest(total)\n            }\n        })\n            .catch(e => {\n                console.log(e, 'wrong');\n\n            })\n    }\n\n\n    //查询检测状态 0 （可以继续检测）1（当前正在检测）2（检测上限）\n    const GetTestStatusStart = useCallback(\n        () => {\n            let timer2:any;\n\n            if (!account) return\n\n            getTestStatus({ user_address: account }).then((res: any) => {\n\n                if (res.code === 200) {\n                    const { data, msg } = res\n                   \n                    if (data.status === \"2\") {\n                        setErrOpen(true)\n                        seterrorMsg(msg)\n                    }\n                    if (data.status === \"1\") {\n                        setAddressContract(data.address)\n                        localStorage.setItem('chain', data.chain)\n                        setselectChain(data.chain)\n                        setTesting(true)\n                        const reParams = {\n                            token_address: data.address,\n                            chain: data.chain,\n                            user_address: account\n                        }\n                        timer2 = setTimeout(() => {\n                            testAddress(1,reParams)\n                        }, 3000);\n                    }\n                    if (data.status === \"0\") {\n                        setTesting(false)\n                        setdetectIng(false)\n                        clearTimeout(timer2)\n                        if (contrastRegex.test(AddressContract)) {\n                            testAddress()\n                        }\n\n                    }\n                }\n\n                else {\n\n                    setErrOpen(true)\n                    seterrorMsg(res.msg)\n                }\n\n\n            })\n        },\n        // eslint-disable-next-line\n        [AddressContract, account, selectChain],\n    )\n\n\n    //初始化\n    const PageStart = useCallback(\n        () => {\n            setErrOpen(false)\n            seterrorMsg('')\n            setcontrastErrText('')\n            setcurrIndex(0)\n            setAddressContract('')\n            // setTakeResultAllTime(false)\n            setoverTimer(false)\n            localStorage.setItem('TakeResultAllTime', 'false')\n\n        },\n        // eslint-disable-next-line\n        [account],\n    )\n\n\n    useEffect(() => {\n        localStorage.setItem('chain', 'BSC')\n        handleListTotal()\n        PageStart()\n        GetTestStatusStart()\n        // eslint-disable-next-line\n        return () => {\n\n            if (timer1) {\n                clearTimeout(timer1)\n            }\n        }\n        // eslint-disable-next-line\n    }, [account])\n\n\n\n\n    return <ContainerCon className=\"ContractDetection\">\n        {/* 合约检测入口 */}\n        <div className=\"homeContainer\">\n            {/* 内容区域 */}\n            <div className=\"container\">\n                <WidthDiv className='ContracDec'>\n                    <div className=\"title\">Address Security Scan\n                        <span></span></div>\n                    <div className=\"tabs\">\n                    Conduct a comprehensive scan of your address for security vulnerabilities.\n                    </div>\n                    {\n                        Testing ? <ShowDecting>\n                            {\n                                overTimer ?\n                                    <>\n                                        <div className=\"loading\"></div>\n                                        <div className='text'>Too many requests, please wait</div>\n                                    </> : <>\n                                        <div className=\"loading\"></div>\n                                        <div className=\"text\">Detecting…</div>\n                                    </>\n                            }\n\n                        </ShowDecting> : <div className=\"addreccCon\">\n                            {/* <div className=\"select\">\n                                <Select defaultValue=\"BSC\" onChange={handleChange} dropdownClassName='dropCon' showArrow >\n                                    <Option value=\"BSC\">  <img src={bscPic} alt=\"\" /> BSC</Option>\n                                    <Option value=\"ETH\">  <img src={ethPic} alt=\"\" /> ETH</Option>\n                                    <Option value=\"Optimism\">  <img src={optimismPic} alt=\"\" /> Optimism</Option>\n                                    <Option value=\"Polygon\">  <img src={polyPic} alt=\"\" /> Polygon</Option>\n                                    <Option value=\"Avalanche\">  <img src={avaPic} alt=\"\" /> Avalanche</Option>\n                                </Select>\n                            </div> */}\n                            <div className=\"inputCon\">\n                                {/* <Input value={AddressContract} onUserInput={val => setAddressContract(val)} placeholder='Please enter the Token address' ShowRed={contrastErrText === '' || AddressContract === ''} setcontrastErrText={setcontrastErrText} ></Input> */}\n                                 <img src={AddressIcon} alt=\"\" /> <span>Your address: {account }</span>\n                            </div>\n                            <div className=\"err\">{contrastErrText}</div>\n                        </div>\n                    }\n\n                    {\n                        !Testing && <StyleButton onClick={styleButton.event}>{styleButton.text}</StyleButton>\n                    }\n                  \n\n\n\n                </WidthDiv>\n            </div>\n        </div>\n        <IntroDiv>\n            {/* <div>\n                <div className=\"top\">4</div>\n                <div className=\"bottom\">Engines</div>\n            </div> */}\n            <div>\n                <div className=\"top\">5</div>\n                <div className=\"bottom\">Public Chains Supported</div>\n            </div>\n\n            <div>\n                <div className=\"top\">119K+</div>\n                <div className=\"bottom\">Malicious Contracts Collected</div>\n            </div>\n            <div>\n                <div className=\"top\">{TotalTest || '--'} +</div>\n                <div className=\"bottom\">Scan Adresses</div>\n            </div>\n        </IntroDiv>\n        <ComingDiv>\n            <div className=\"tit\">Address security scan</div>\n            <div className=\"intro\">Conduct a comprehensive scan of your address for security vulnerabilities</div>\n            <div className=\"go\" onClick={()=>{window.open(\"https://www.triathon.space/tokenDetections/#/\")}}>Go</div>\n        </ComingDiv>\n        <BottomDiv>\n            <div className=\"left\">\n                <img src={leftShowPic} alt=\"\" />\n            </div>\n            <div className=\"right\">\n                <img src={rightShowPic} alt=\"\" />\n            </div>\n        </BottomDiv>\n        <ErrModel\n            isOpen={ErrOpen}\n            onDismiss={closeErrTip}\n            errorMsg={errorMsg}\n        ></ErrModel>\n    </ContainerCon>\n}"],"sourceRoot":""}